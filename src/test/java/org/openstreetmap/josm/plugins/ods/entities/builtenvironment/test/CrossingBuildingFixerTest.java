package org.openstreetmap.josm.plugins.ods.entities.builtenvironment.test;

import org.junit.Test;
import org.openstreetmap.josm.plugins.ods.entities.builtenvironment.Building;
import org.openstreetmap.josm.plugins.ods.entities.builtenvironment.CrossingBuildingFixer;

import com.vividsolutions.jts.io.ParseException;

public class CrossingBuildingFixerTest  {
    
    @Test
    public void testFix() throws ParseException {
        Building building1 = new MockBuilding("MULTIPOLYGON (((5.122603307428826 52.07947509246981, 5.1226077332760465 52.07948152888103, 5.122631295056017 52.079518154261386, 5.122483506093581 52.07955246256768, 5.122471318893761 52.07953379392178, 5.122377249173183 52.07955712243126, 5.122362011608539 52.07953378210788, 5.122456326939868 52.07951084963766, 5.122603307428826 52.07947509246981)))");
        Building building2 = new MockBuilding("MULTIPOLYGON (((5.1221287448168145 52.07951013151931, 5.1222648854017345 52.07947460206607, 5.122522628524404 52.07940733897208, 5.122550612963508 52.07939911478602, 5.122552843151158 52.079401879133364, 5.1225520830498 52.07940213808137, 5.122552589101336 52.0794029032043, 5.122553582286895 52.07940269870797, 5.1225604384969134 52.07941258301187, 5.122570109952588 52.079415103408316, 5.12258026256261 52.079430001471565, 5.122576289498421 52.07943580784188, 5.122584404645537 52.07944742068171, 5.122593886682453 52.07944990469866, 5.122604258123975 52.079464803250914, 5.122600212333784 52.07947057350644, 5.122603307428826 52.07947509246981, 5.122456326939868 52.07951084963766, 5.122349068045402 52.07953693481059, 5.122185535228098 52.07957670807821, 5.1221287448168145 52.07951013151931)))");
        System.out.println(building1.getGeometry().getNumPoints());
        System.out.println(building2.getGeometry().getNumPoints());
        CrossingBuildingFixer fixer = new CrossingBuildingFixer(1e-7);
        fixer.setBuildings(building1, building2);
        fixer.fix();
        System.out.println(building1.getGeometry().getNumPoints());
        System.out.println(building2.getGeometry().getNumPoints());
    }
}
